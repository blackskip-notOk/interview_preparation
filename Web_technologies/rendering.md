# **Веб технологии**

## **Ссылки:**

* [прогрессивный рендеринг](#прогрессивный-рендеринг)

## **Прогрессивный рендеринг**

Технологии, используемые для ускорения отрисовки страниц (в частности, уменьшение времени загрузки), чтобы показать пользователю контент как можно скорее. До того, как широкополосный интернет распространился повсеместно, прогрессивный рендеринг встречался довольно часто. Но этот подход по прежнему полезен в современной разработке, поскольку все более популярным (и ненадежным) становится мобильный доступ в интернет.

Примеры технологий:

* Ленивая загрузка картинок. Картинки на странице не загружаются все разом. **JavaScript** подгрузит картинки тогда, когда пользователь доскроллит до той части страницы, на которой они расположены.

* Приоритизация видимого контента. Только минимум CSS, контента, скриптов, необходимых для отрисовки той части страницы, которую пользователь увидит первой. Вы можете использовать отложенные скрипты или слушать события `DOMContentLoaded` или `load`, чтобы загрузить остальные ресурсы и контент.

* Асинхронные фрагменты `HTML`. Отправка в браузер частей HTML-страницы, созданной на бэкенде. Более подробно про эту технологию можно почитать в [этой статье](https://habr.com/ru/company/skillfactory/blog/540294/).

***

### **Рендеринг на стороне клиента**

**CSR** – это метод, при котором контент рендерится в браузере с помощью **JavaScript**. Вместо того чтобы получать весь контент из самого HTML-файла, сервер отправляет **HTML** с пустым `body` и тегами `script`, в которых содержатся ссылки на JavaScript-бандлы, с помощью которых браузер будет рендерить контент. Браузер анализирует **HTML** и шлёт HTTP-запросы для получения JS-бандлов. В это время пользователь видит либо часть содержимого **HTML**, либо пустую страницу, либо индикатор загрузки. Только после того как основной JS-бандл получен и отрисован, пользователь видит реальный, значимый контент. В **CSR** после загрузки **JS** контент будет загружаться асинхронно. Мы можем сначала загрузить критически важный контент, а затем второстепенный. **CSR** имеет небольшое преимущество благодаря кэшированию загруженных JS-бандлов и статического **HTML**, поэтому навигация между страницами становится очень быстрой. Однако в **CSR** контент начинает загружаться только после выполнения всего JavaScript-бандла, а пользователям приходится сидеть сложа руки, просто наблюдая за пустым экраном без понимания, что происходит. По мере увеличения размера бандла пользователям придется ждать всё больше и больше, прежде чем они увидят что-нибудь осмысленное или начнут использовать страницу.
***

### **Рендеринг на стороне сервера**

**SSR** - HTML-код рендерится на сервере и отправляется клиенту. Контент, который нам нужно отобразить на экране, становится доступен сразу после анализа **HTML**; следовательно, первичный рендеринг контента происходит быстрее, чем у **CSR**. Браузер запрашивает **HTML** с сервера.
Сервер делает API запросы и рендерит HTML-контент на своей стороне. Скомпилированный HTML-код отправляется в браузер. Как только браузер загружает и анализирует **HTML**, веб-приложение становится доступным для конечного пользователя, не дожидаясь загрузки JS-бандлов. Браузер загружает и запускает JS-бандлы, чтобы сделать страницу интерактивной. Поскольку API обычно размещён на сервере, а исходный **JavaScript** не блокирует контент, в **SSR** исходный контент загружается очень быстро. Хотя мы и получаем быструю отрисовку контента, страница не будет интерактивной, пока мы не загрузим и не выполним **JS**.
***

### **Прогрессивный рендеринг на стороне сервера**

Ключом к ускорению веб-страницы является метод последовательного рендеринга частей веб-страницы на стороне сервера и отправки их клиенту по частям, не дожидаясь, пока будет отрисована вся страница.
Прогрессивный рендеринг на стороне сервера (**PSSR**) основан на концепции потоковой передачи **HTML**. **PSSR** разбивает страницы на осмысленные компоненты с помощью разделения кода. Эти части страницы управляются разными скриптами, и теперь у нас есть возможность сделать гидратацию независимо. Браузер запрашивает у сервера HTML-код.
Сервер делает API запросы и сначала рендерит критический контент, а затем отправляет его клиенту.
Браузер анализирует **HTML** и отображает его на экране. Сервер рендерит некритический контент и передает его браузеру. Затем браузер анализирует и отображает некритичный контент. Между тем JS-бандлы загружаются и выполняются в фоновом режиме, а браузер передаёт интерактивность элементам **DOM**.
**PSSR** повышает производительность вашего веб-приложения, извлекая и визуализируя компоненты страницы параллельным и приоритетным образом. Этот подход известен как метод прогрессивной гидратации.

Особенности метода прогрессивной гидратации:

* Рендер компонента не происходит до тех пор, пока он не появится в поле зрения или не понадобится для взаимодействия с пользователем.

* Загрузка контента при взаимодействии с пользователем (прокрутка) – намного быстрее, чем при **CSR** или **SSR**.

* Тестирование показывает, что это может сократить время до появления первого интерактивного элемента.
Впечатления приятнее даже при медленном соединении.

***

### **Критические этапы рендеринга**

Оптимизация критических этапов рендеринга относится к приоритизации расположения контента, который связан с текущей деятельностью пользователя. Браузер выполняет много негласной работы, чтобы впечатления от работы со страницей были приятнее. Критические этапы рендеринга – это непосредственные шаги между получением **HTML**, **CSS** и **JS** и обработкой, необходимой для их преобразования в видимые пиксели.
